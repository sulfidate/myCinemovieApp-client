<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: ProfileView/profile-view.jsx</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: ProfileView/profile-view.jsx</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState } from 'react'
import PropTypes from 'prop-types'
import axios from 'axios'
import {
  Form,
  Button,
  Container,
  Row,
  Col,
  Card,
  CardGroup,
  Navbar,
  FormGroup,
} from 'react-bootstrap'
import './profile-view.scss'
import { Redirect, Link } from 'react-router-dom'
import MovieCard from '../MovieCard/movie-card'
import CurrentUserData from './current-userdata'

/**
 * ProfileView component
 * @Component ProfileView component
 *
 */
export default class ProfileView extends React.Component {
  constructor() {
    super()

    this.state = {
      Username: null,
      Password: null,
      Email: null,
      Birthday: null,
      FavoriteMovies: [],
    }
  }

  /**
   * function to remove movie from favorites
   * @type {removeFavMovie}
   * @param {movie} - movie to be removed from favorites
   * @returns {movie} - movie to be removed from favorites
   */
  onRemoveFavorite = (m) => {
    const user = localStorage.getItem('user')
    const token = localStorage.getItem('token')
    axios
      .delete(
        `https://mycinemoviedatabase.herokuapp.com/users/${user}/FavoritesDelete/${m._id}`,
        { headers: { Authorization: `Bearer ${token}` } }
      )
      .then((response) => {
        localStorage.setItem(
          'favMovies',
          JSON.stringify(response.data.FavoriteMovies)
        )
        window.location.reload()
      })
      .catch(function (error) {
        console.log(error)
      })
  }

  /**
   * function to edit user data
   * @event {editUserData}
   * @param {object} event
   * @returns {object}
   */
  editUser = (e) => {
    e.preventDefault()
    const username = localStorage.getItem('user')
    const token = localStorage.getItem('token')

    axios
      .put(
        `https://mycinemoviedatabase.herokuapp.com/users/${username}`,
        {
          Username: this.state.Username,
          Password: this.state.Password,
          Email: this.state.Email,
          Birthday: this.state.Birthday,
        },
        {
          headers: { Authorization: `Bearer ${token}` },
        }
      )
      .then((response) => {
        this.setState({
          Username: response.data.Username,
          Password: response.data.Password,
          Email: response.data.Email,
          Birthday: response.data.Birthday,
        })

        localStorage.setItem('user', this.state.Username)
        const data = response.data
        alert('Profile is updated!')
        window.open(`/users/${Username}`, '_self')
      })
      .catch(function (error) {
        console.log(error)
      })
  }

  /**
   * function to delete user
   * @event {deleteUser}
   * @param {object} event
   * @returns {object}
   */
  onDeleteUser() {
    const confirmed = window.confirm(
      'Are you sure you want to delete your account?'
    )
    if (confirmed) {
      const user = localStorage.getItem('user')
      const token = localStorage.getItem('token')
      axios
        .delete(`https://mycinemoviedatabase.herokuapp.com/users/${user}`, {
          headers: { Authorization: `Bearer ${token}` },
        })
        .then(() => {
          alert(user + 'has been deleted')
          localStorage.removeItem('user')
          localStorage.removeItem('token')
          window.location.pathname = '/'
        })
        .catch(function (error) {
          console.log(error)
        })
    }
  }

  /**
   * function to set username
   * @function setUsername
   * @param {*} value
   * @returns {object}
   */
  setUsername(value) {
    this.setState({
      Username: value,
    })
    this.Username = value
  }

  /**
   * function to set password
   * @function setPassword
   * @param {*} value
   * @returns {object}
   */
  setPassword(value) {
    this.setState({
      Password: value,
    })
    this.Password = value
  }

  /**
   * function to set email
   * @function setEmail
   * @param {*} value
   * @returns {object}
   */
  setEmail(value) {
    this.setState({
      Email: value,
    })
    this.Email = value
  }

  /**
   * function to set birthday
   * @function setBirthday
   * @param {*} value
   * @returns {object}
   */
  setBirthday(value) {
    this.setState({
      Birthday: value,
    })
    this.Birthday = value
  }

  render() {
    const { movies, user } = this.props
    const { FavoriteMovies, Username, Email, Birthday } = this.props

    return (
      &lt;Container>
        &lt;Row className='profile-view mt-7 mb-7' style={{ minWidth: '400px' }}>
          &lt;Col>
            &lt;CardGroup>
              &lt;Card
                bg='light'
                key=''
                text='info'
                className='user-profile mb-2'
                border='info'
              >
                &lt;Card.Header as='h3'>User Profile&lt;/Card.Header>

                {/* current-userdata */}
                &lt;CurrentUserData
                  name={Username}
                  email={Email}
                  Birthday={Birthday}
                />

                {/* favorites-movies */}
                &lt;Card.Body className='favorites-movies-data'>
                  &lt;Card.Title as='h5' style={{ margin: '0.5% 0 1% 0' }}>
                    Your Favorite Movies
                  &lt;/Card.Title>

                  &lt;Card
                    style={{
                      border: '0.1rem solid #17a2b8',
                    }}
                  >
                    &lt;Card.Body>
                      {FavoriteMovies.length === 0 &amp;&amp; (
                        &lt;div className='text-center'>No Favorite Movie&lt;/div>
                      )}
                      &lt;Row className='favorite-container'>
                        {FavoriteMovies.length > 0 &amp;&amp;
                          movies.map((movie) => {
                            if (
                              movie._id ===
                              FavoriteMovies.find((fav) => fav === movie._id)
                            ) {
                              return (
                                &lt;Col
                                  sm={6}
                                  md={6}
                                  lg={4}
                                  xl={4}
                                  xxl={2}
                                  key={movie._id}
                                >
                                  &lt;Card>
                                    &lt;MovieCard movie={movie} />
                                    &lt;Button
                                      size='sm'
                                      variant='outline-warning'
                                      value={movie._id}
                                      onClick={() =>
                                        this.onRemoveFavorite(movie)
                                      }
                                    >
                                      {' '}
                                      Remove{' '}
                                    &lt;/Button>
                                  &lt;/Card>
                                &lt;/Col>
                              )
                            }
                          })}
                      &lt;/Row>
                    &lt;/Card.Body>
                  &lt;/Card>
                &lt;/Card.Body>

                {/* user-update */}
                &lt;Card.Body className='user-update'>
                  &lt;Form.Label as='h5' style={{ margin: '0.5% 0 1% 0' }}>
                    Update your profile
                  &lt;/Form.Label>

                  &lt;Form
                    className='update-form'
                    style={{
                      border: '0.1rem solid #17a2b8',
                      padding: '1.5rem',
                    }}
                    onSubmit={(e) =>
                      this.editUser(
                        e,
                        this.Username,
                        this.Password,
                        this.Email,
                        this.Birthday
                      )
                    }
                  >
                    &lt;Form.Group className='form-group-username'>
                      &lt;Form.Label className='form-label colorInfo'>
                        Username:
                        &lt;span className='ml-2'>{Username}&lt;/span>
                      &lt;/Form.Label>
                      &lt;Form.Control
                        style={{ fontSize: 'small' }}
                        type='text'
                        placeholder='Username cannot be updated. (To get a new username delete profile and register with new username!)'
                        disabled
                        value={this.username}
                      />
                      &lt;Form.Text className='text-muted'>
                        &lt;p>&lt;/p>
                      &lt;/Form.Text>
                    &lt;/Form.Group>

                    &lt;Form.Group className='form-group-password'>
                      &lt;Form.Label className='form-label colorInfo'>
                        Update password:
                      &lt;/Form.Label>
                      &lt;Form.Control
                        type='password'
                        name='Password'
                        placeholder='Choose new password - at least 6 Chars'
                        onChange={(e) => this.setPassword(e.target.value)}
                      />
                      &lt;Form.Text className='text-muted'>
                        &lt;p>&lt;/p>
                      &lt;/Form.Text>
                    &lt;/Form.Group>

                    &lt;Form.Group className='form-group-email'>
                      &lt;Form.Label className='form-label colorInfo'>
                        Update email:
                      &lt;/Form.Label>
                      &lt;Form.Control
                        type='email'
                        name='Email'
                        placeholder='Enter new email - valid format: xxx@xxx.xxx'
                        onChange={(e) => this.setEmail(e.target.value)}
                      />
                      &lt;Form.Text className='text-muted'>
                        &lt;p>&lt;/p>
                      &lt;/Form.Text>
                    &lt;/Form.Group>

                    &lt;Form.Group className='form-group-birthday'>
                      &lt;Form.Label className='form-label colorInfo'>
                        Update birthday
                      &lt;/Form.Label>
                      &lt;Form.Control
                        type='date'
                        name='Birthday'
                        onChange={(e) => this.setBirthday(e.target.value)}
                      />
                    &lt;/Form.Group>

                    &lt;Container className='form-btn'>
                      &lt;Button
                        className='form-btn-sbm'
                        variant='info'
                        type='submit'
                        onClick={this.editUser}
                      >
                        Update User
                      &lt;/Button>

                      &lt;Button
                        className='form-btn-del'
                        variant='outline-danger'
                        style={{
                          border: '1px solid #17a2b8',
                          color: '#17a2b8',
                        }}
                        onClick={() => this.onDeleteUser()}
                      >
                        {' '}
                        &lt;span>Delete User&lt;/span>{' '}
                      &lt;/Button>
                    &lt;/Container>
                  &lt;/Form>
                &lt;/Card.Body>
              &lt;/Card>
            &lt;/CardGroup>
          &lt;/Col>
        &lt;/Row>
      &lt;/Container>
    )
  }
}

/**
 * PropTypes Profile View
 *  @PropTypes {object} props
 */
ProfileView.propTypes = {
  profile: PropTypes.shape({
    Username: PropTypes.string.isRequired,
    Password: PropTypes.string.isRequired,
    Email: PropTypes.string.isRequired,
    Birthday: PropTypes.string,
  }),
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module.exports.html">exports</a></li></ul><h3>Events</h3><ul><li><a href="global.html#event:handleSubmit">handleSubmit</a></li><li><a href="global.html#event:handleSubmit-registrationform">handleSubmit - registration form</a></li><li><a href="global.html#event:%257BaddFavMovie%257D">{addFavMovie}</a></li><li><a href="global.html#event:%257BcheckIfMovieIsInFavorites%257D">{checkIfMovieIsInFavorites}</a></li><li><a href="global.html#event:%257BdeleteUser%257D">{deleteUser}</a></li><li><a href="global.html#event:%257BeditUserData%257D">{editUserData}</a></li><li><a href="global.html#event:%257BremoveFavMovie%257D">{removeFavMovie}</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addFavMovie">addFavMovie</a></li><li><a href="global.html#componentDidMount">componentDidMount</a></li><li><a href="global.html#getMovies">getMovies</a></li><li><a href="global.html#handleSubmit">handleSubmit</a></li><li><a href="global.html#handleSubmit-loginformsubmitpassword">handleSubmit - login form submit password</a></li><li><a href="global.html#handleSubmit-loginformsubmitusername">handleSubmit - login form submit username</a></li><li><a href="global.html#onLoggedIn">onLoggedIn</a></li><li><a href="global.html#onLoggedOut">onLoggedOut</a></li><li><a href="global.html#setBirthday">setBirthday</a></li><li><a href="global.html#setEmail">setEmail</a></li><li><a href="global.html#setPassword">setPassword</a></li><li><a href="global.html#setUsername">setUsername</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Tue Jun 07 2022 21:29:13 GMT+0200 (Mitteleuropäische Sommerzeit)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
